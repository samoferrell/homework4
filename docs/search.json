[
  {
    "objectID": "homework4qmd.html",
    "href": "homework4qmd.html",
    "title": "Homeowrk 4 - ST558",
    "section": "",
    "text": "In this document, we will be writing functions and dealing with missing values. We will start by answering conceptual questions about this weeks lecture material."
  },
  {
    "objectID": "homework4qmd.html#task-1-conceptual-questions",
    "href": "homework4qmd.html#task-1-conceptual-questions",
    "title": "Homeowrk 4 - ST558",
    "section": "Task 1: Conceptual Questions",
    "text": "Task 1: Conceptual Questions\n\nWhat is the purpose of the lapply() function? What is the equivalent purrr function? &gt; The purpose of the lapply() function is to apply a function to each element in a list. The equivalent purrr function is the map() function\nSuppose we have a list called my_list. Each element of the list is a numeric data frame (all columns are numeric). We want use lapply() to run the code cor(numeric_matrix, method = “kendall”) on each element of the list. Write code to do this below! (I’m really trying to ask you how you specify method = “kendall” when calling lapply()) &gt; lapply(numeric_namtrix = my_list, method = “kendall”)\nWhat are two advantages of using purrr functions instead of the BaseR apply family? &gt; The purrr functions have common function names and syntax across functions.\nWhat is a side-effect function? &gt; A side-effect function is a function that doesn’t change anything it just creates output.\nWhy can you name a variable sd in a function and not cause any issues with the sd function? &gt; Inside the function when we call it, there is a temporary function environment which is then destroyed after running the funciton."
  },
  {
    "objectID": "homework4qmd.html#task-2-writing-r-functions",
    "href": "homework4qmd.html#task-2-writing-r-functions",
    "title": "Homeowrk 4 - ST558",
    "section": "Task 2: Writing R Functions",
    "text": "Task 2: Writing R Functions\nFirst, we will write a function that finds the RMSE of a response vector and a respective predictions vector.\n\n# I will be adding ... into the function to apply other arguments after the fact. \ngetRMSE &lt;- function(responses, predictions,...){\n  RMSE &lt;- sqrt(mean((responses - predictions)^2,...))\n  return(RMSE)\n}\n\nNow, I will test the function after creating data with no missing values.\n\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\ngetRMSE(responses = resp, predictions = pred)\n\n[1] 0.9581677\n\n\nNow, I will test the function after creating a vector “resp_NA” which contains missing values.\n\nresp_NA &lt;- c(resp[1:98],NA_real_,NA_real_)\n# First we will apply the function without removing the missing values to verify an error. \ngetRMSE(responses = resp_NA, predictions = pred)\n\n[1] NA\n\n# Then we will apply the function with specifying, na.rm = TRUE to remove the missing values.\ngetRMSE(responses = resp_NA, predictions = pred, na.rm = TRUE)\n\n[1] 0.9605\n\n\nNow we will be writing a function to calculate the MAE of a response vector and a respective predictions vector.\n\n# I will be adding ... into the function to apply other arguments after the fact. \ngetMAE &lt;- function(responses, predictions, ...){\n  RMSE &lt;- mean(abs(responses - predictions),...)\n  return(RMSE)\n}\n\nNow I will test the getMAE function:\n\ngetMAE(responses = resp, predictions = pred)\n\n[1] 0.8155776\n\n\nNow I will test the getMAE function with missing data.\n\n# First we will apply the function without removing the missing values to verify an error. \ngetMAE(responses = resp_NA, predictions = pred)\n\n[1] NA\n\n# Then we will apply the function with specifying, na.rm = TRUE to remove the missing values.\ngetMAE(responses = resp_NA, predictions = pred, na.rm = TRUE)\n\n[1] 0.8181006\n\n\nNow, we will create a wrapper function that calculates the RMSE and/or MAE.\n\nmy_wrapper &lt;- function(responses, predictions, get = \"both\"){\n  # First we will combine the vectors to more efficiently check for missing/incorrect data.\n  both_vectors &lt;- c(responses, predictions)\n  \n  # We will create a vector of logical objects from checking if the vectors \n  # are numerical, vectors, atomic, or missing.\n   if (FALSE %in% c(is.numeric(both_vectors), \n                    is.vector(both_vectors), \n                    is.atomic(both_vectors), \n                    !is.na(both_vectors))) {\n    stop(\"Input must be an atomic numeric vector, with no missing values.\")}\n  \nRMSE &lt;- getRMSE(responses, predictions)\nMAE &lt;- getMAE(responses, predictions)\n\n# I will use my local get object to pull any specific calculations.\n  if (get == \"both\"){\n  return(list(\"Root Mean Square Error\" = RMSE, \"Mean Absolute Deviation\" = MAE))}\n    else if (get == \"RMSE\"){\n    return(list(\"Root Mean Square Error\" = RMSE))}\n      else if (get == \"MAE\"){\n      return(list(\"Mean Absolute Deviation\" = MAE))}\n        else \n          {stop(\"For 'get' argument, specify RMSE, MAE, or both\")}\n  }\n\nNow, we will test the wrapper function. - First, we will test by calling for each metric individually.\n\nmy_wrapper(resp, pred, \"RMSE\")\n\n$`Root Mean Square Error`\n[1] 0.9581677\n\nmy_wrapper(resp, pred, \"MAE\")\n\n$`Mean Absolute Deviation`\n[1] 0.8155776\n\n\n\nNow, we will apply the function specifying both metrics to be returned:\n\n\nmy_wrapper(resp,pred, \"both\")\n\n$`Root Mean Square Error`\n[1] 0.9581677\n\n$`Mean Absolute Deviation`\n[1] 0.8155776\n\n\n\nNow we will repeat with a vector containing missing values.\n\n\nmy_wrapper(resp_NA, pred)\n\nError in my_wrapper(resp_NA, pred): Input must be an atomic numeric vector, with no missing values.\n\n\n\nNow we will apply the function to the incorrect data object (a data frame):\n\n\nresp_data_frame &lt;- data.frame(resp)\nmy_wrapper(resp_data_frame, pred)\n\nError in my_wrapper(resp_data_frame, pred): Input must be an atomic numeric vector, with no missing values."
  },
  {
    "objectID": "homework4qmd.html#task-3-querying-an-api-and-a-tidy-style-function",
    "href": "homework4qmd.html#task-3-querying-an-api-and-a-tidy-style-function",
    "title": "Homeowrk 4 - ST558",
    "section": "Task 3: Querying an API and a Tidy-Style Function",
    "text": "Task 3: Querying an API and a Tidy-Style Function\nd042b6702b44494f8531596ad64cf58c\n\nUse GET() from the httr package to return information about a topic that you are interested in that has been in the news lately (store the result as an R object). Note: We can only look 30 days into the past with a free account.\n\n\nurl_id &lt;- \"https://newsapi.org/v2/top-headlines?country=us&category=business&apiKey=d042b6702b44494f8531596ad64cf58c\"\nid_info &lt;- httr::GET(url_id)\nstr(id_info, max.level = 1)\n\nList of 10\n $ url        : chr \"https://newsapi.org/v2/top-headlines?country=us&category=business&apiKey=d042b6702b44494f8531596ad64cf58c\"\n $ status_code: int 200\n $ headers    :List of 14\n  ..- attr(*, \"class\")= chr [1:2] \"insensitive\" \"list\"\n $ all_headers:List of 1\n $ cookies    :'data.frame':    0 obs. of  7 variables:\n $ content    : raw [1:13505] 7b 22 73 74 ...\n $ date       : POSIXct[1:1], format: \"2024-06-25 16:17:42\"\n $ times      : Named num [1:6] 0 0.209 0.233 0.311 0.802 ...\n  ..- attr(*, \"names\")= chr [1:6] \"redirect\" \"namelookup\" \"connect\" \"pretransfer\" ...\n $ request    :List of 7\n  ..- attr(*, \"class\")= chr \"request\"\n $ handle     :Class 'curl_handle' &lt;externalptr&gt; \n - attr(*, \"class\")= chr \"response\"\n\n\n\nNow we will parse what is returned and find our way to the data frame that has the actual article information in it.\n\n\nlibrary(jsonlite)\n\nWarning: package 'jsonlite' was built under R version 4.3.3\n\nparsed &lt;- fromJSON(rawToChar(id_info$content))\nheadline_info &lt;- tibble::as_tibble(parsed$articles)\n\n\nNow we will write a quick function that allows the user to easily query this API. The inputs to the function should be the title/subject to search for (string), a time period to search from (string - you’ll search from that time until the present), and an API key.\n\n\nlibrary(tidyverse)\n\nWarning: package 'tidyverse' was built under R version 4.3.3\n\n\nWarning: package 'readr' was built under R version 4.3.3\n\n\nWarning: package 'lubridate' was built under R version 4.3.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter()  masks stats::filter()\n✖ purrr::flatten() masks jsonlite::flatten()\n✖ dplyr::lag()     masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(purrr)\n\nThis function will take in a url. If no title_keywords are specified, it returns the whole data set. If title_keywords are specified, it will search the title to find matches and filter based on those matches.\n\naccess &lt;- function(url_id, title_keywords = NULL, starting_year = 0,...){\n  id_info &lt;- httr::GET(url_id)\n  parsed &lt;- fromJSON(rawToChar(id_info$content))\n  headline_info &lt;- tibble::as_tibble(parsed$articles)\n  # if no title keywords are specified, return the whole data set.\n  if (is.null(title_keywords)){\n  return(headline_info)}\n  else {\n  \n  # lower case the title keywords and create a \n  lower_case &lt;- tolower(title_keywords)\n  vector_keywords &lt;- paste(lower_case, collapse = \"|\")\n\n   filtered &lt;- headline_info |&gt;\n    filter(grepl(vector_keywords, tolower(title)),\n           as.numeric(substr(publishedAt,1,4)) &gt;= starting_year)\n  # if title keywords are specified, we will use str_detect to find look through and filter the titles.\n  return(filtered)}\n}\n\nWe will test our function by accessing the API used before.\n\naccess(url_id = \"https://newsapi.org/v2/top-headlines?country=us&category=business&apiKey=d042b6702b44494f8531596ad64cf58c\")\n\n# A tibble: 20 × 8\n   source$id $name author title description url   urlToImage publishedAt content\n   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n 1 reuters   Reut… Reute… Nvid… &lt;NA&gt;        http… &lt;NA&gt;       2024-06-24…  &lt;NA&gt;  \n 2 reuters   Reut… Reute… Fast… &lt;NA&gt;        http… &lt;NA&gt;       2024-06-24…  &lt;NA&gt;  \n 3 &lt;NA&gt;      Yaho… &lt;NA&gt;   Anal… &lt;NA&gt;        http… &lt;NA&gt;       2024-06-24… \"If yo…\n 4 &lt;NA&gt;      Yaho… Gerry… Alny… (Bloomberg… http… https://s… 2024-06-24… \"(Bloo…\n 5 &lt;NA&gt;      Barr… Barro… Nvid… &lt;NA&gt;        http… &lt;NA&gt;       2024-06-24…  &lt;NA&gt;  \n 6 &lt;NA&gt;      Ambc… Samue… Bitc… Metaplanet… http… https://a… 2024-06-24… \"&lt;ul&gt;&lt;…\n 7 associat… Asso… FATIM… Yell… The Biden … http… https://d… 2024-06-24… \"WASHI…\n 8 abc-news  ABC … WYATT… Car … Car dealer… http… https://i… 2024-06-24… \"NEW Y…\n 9 &lt;NA&gt;      Decr… Taran… Near… In stark c… http… https://c… 2024-06-24… \"Bears…\n10 &lt;NA&gt;      Yaho… Brett… Stoc… Stocks are… http… https://s… 2024-06-24… \"US st…\n11 google-n… Goog… NBC P… Pass… &lt;NA&gt;        http… &lt;NA&gt;       2024-06-24…  &lt;NA&gt;  \n12 google-n… Goog… CNBC   Mond… &lt;NA&gt;        http… &lt;NA&gt;       2024-06-24…  &lt;NA&gt;  \n13 google-n… Goog… Inves… 5 Th… &lt;NA&gt;        http… &lt;NA&gt;       2024-06-24…  &lt;NA&gt;  \n14 google-n… Goog… Benzi… What… &lt;NA&gt;        http… &lt;NA&gt;       2024-06-24…  &lt;NA&gt;  \n15 google-n… Goog… Motor… Duma… &lt;NA&gt;        http… &lt;NA&gt;       2024-06-24…  &lt;NA&gt;  \n16 &lt;NA&gt;      AL.c… Leada… Big … Your next … http… https://w… 2024-06-24… \"Big c…\n17 techradar Tech… Alex … Oops… Can you sp… http… https://c… 2024-06-24… \"Has A…\n18 &lt;NA&gt;      Hind… Ashim… Elon… Elon Musk … http… https://w… 2024-06-24… \"Elon …\n19 bloomberg Bloo… Hema … Jain… Bobby Jain… http… https://a… 2024-06-24… \"Bobby…\n20 &lt;NA&gt;      Glob… ANI P… ANI … Conference… http… https://m… 2024-06-24… \"Confe…\n\n\nNow, we will test it by specifying keywords to select different articles.\n\naccess(url_id = \"https://newsapi.org/v2/top-headlines?country=us&category=business&apiKey=d042b6702b44494f8531596ad64cf58c\", title_keywords = c(\"hedge\", \"prime day\"))\n\n# A tibble: 2 × 8\n  source$id $name  author title description url   urlToImage publishedAt content\n  &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n1 techradar TechR… Alex … Oops… Can you sp… http… https://c… 2024-06-24… \"Has A…\n2 bloomberg Bloom… Hema … Jain… Bobby Jain… http… https://a… 2024-06-24… \"Bobby…\n\n\nNow, lets try testing it by accessing a different link.\n\naccess(url_id = \"https://newsapi.org/v2/top-headlines?sources=techcrunch&apiKey=d042b6702b44494f8531596ad64cf58c\")\n\n# A tibble: 10 × 8\n   source$id $name author title description url   urlToImage publishedAt content\n   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n 1 techcrun… Tech… Laure… Bye-… Autonomous… http… https://t… 2024-05-08… \"Auton…\n 2 techcrun… Tech… Alex … $450… This morni… http… https://t… 2024-05-08… \"Good …\n 3 techcrun… Tech… Alex … Watc… Would you … http… https://t… 2024-05-08… \"Apple…\n 4 techcrun… Tech… Rebec… Uber… Uber plans… http… https://t… 2024-05-08… \"Uber …\n 5 techcrun… Tech… Mike … Chec… Checkfirst… http… https://t… 2024-05-08… \"Weve …\n 6 techcrun… Tech… Paul … UK c… Monzo has … http… https://t… 2024-05-08… \"Monzo…\n 7 techcrun… Tech… Brian… iRob… iRobot Tue… http… https://t… 2024-05-08… \"iRobo…\n 8 techcrun… Tech… Devin… Goog… Google Dee… http… https://t… 2024-05-07… \"Googl…\n 9 techcrun… Tech… Tim D… Myco… The startu… http… https://t… 2024-05-07… \"Usual…\n10 techcrun… Tech… Kyle … Cont… Xtend, a d… http… https://t… 2024-05-07… \"Close…\n\n\nUsing this link, we are able to specify different keywords and select only from the recent year.\n\naccess(url_id = \"https://newsapi.org/v2/top-headlines?sources=techcrunch&apiKey=d042b6702b44494f8531596ad64cf58c\", title_keywords = c(\"uber one\", \"crypto\", \"macbooks\"), starting_year = 2024)\n\n# A tibble: 3 × 8\n  source$id  $name author title description url   urlToImage publishedAt content\n  &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n1 techcrunch Tech… Alex … $450… This morni… http… https://t… 2024-05-08… \"Good …\n2 techcrunch Tech… Alex … Watc… Would you … http… https://t… 2024-05-08… \"Apple…\n3 techcrunch Tech… Rebec… Uber… Uber plans… http… https://t… 2024-05-08… \"Uber …"
  }
]